apply plugin: "java"

version '1.0'

sourceCompatibility = 1.8

repositories{
	maven{ url "https://maven.aliyun.com/nexus/content/groups/public/"}
	//jcenter()
	mavenCentral()
	maven{ url 'https://jitpack.io' }
}

ext{
}

dependencies{
	/* Json Import
	 * 1.2MB 
	 */
	compileOnly group: 'com.alibaba', name: 'fastjson', version: '1.2.59'
	/* WEB
	 * 2.3MB 
	 */
	implementation group: 'javax.servlet', name: 'javax.servlet-api', version: '4.0.1'
	compileOnly group: 'org.eclipse.jetty', name: 'jetty-server', version: '9.4.28.v20200408'
	compileOnly group: 'org.eclipse.jetty', name: 'jetty-servlet', version: '9.4.28.v20200408'
	compileOnly group: 'com.google.code.gson', name: 'gson', version: '2.8.7'

}

jar{
	from{
		configurations.runtimeClasspath.collect{it.isDirectory() ? it : zipTree(it)}
	}
	manifest {
		attributes 'Main-Class': 'com.github.dr.webapi.Main'
		attributes 'Launcher-Agent-Class': 'com.github.dr.webapi.dependent.LibraryManager'
	}
}

tasks.withType(JavaCompile) {  
	options.encoding = "UTF-8"  
	options.compilerArgs << "-Xlint:unchecked" << "-Werror"
	options.compilerArgs << "-Xdiags:verbose" << "-Werror"
	options.compilerArgs << "-Xlint:deprecation" << "-Werror"
}